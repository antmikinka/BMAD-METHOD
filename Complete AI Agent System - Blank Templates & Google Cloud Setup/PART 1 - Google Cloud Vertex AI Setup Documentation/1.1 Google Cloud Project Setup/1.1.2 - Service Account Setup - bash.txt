# 1. Create service account
gcloud iam service-accounts create {{COMPANY_NAME}}-ai-agents \
    --description="{{COMPANY_NAME}} AI Agent System Service Account" \
    --display-name="{{COMPANY_NAME}} AI Agents"

# 2. Grant necessary permissions
gcloud projects add-iam-policy-binding {{PROJECT_ID}} \
    --member="serviceAccount:{{COMPANY_NAME}}-ai-agents@{{PROJECT_ID}}.iam.gserviceaccount.com" \
    --role="roles/aiplatform.user"

gcloud projects add-iam-policy-binding {{PROJECT_ID}} \
    --member="serviceAccount:{{COMPANY_NAME}}-ai-agents@{{PROJECT_ID}}.iam.gserviceaccount.com" \
    --role="roles/storage.admin"

gcloud projects add-iam-policy-binding {{PROJECT_ID}} \
    --member="serviceAccount:{{COMPANY_NAME}}-ai-agents@{{PROJECT_ID}}.iam.gserviceaccount.com" \
    --role="roles/cloudsql.admin"

# 3. Create and download service account key
gcloud iam service-accounts keys create {{COMPANY_NAME}}-ai-agents-key.json \
    --iam-account={{COMPANY_NAME}}-ai-agents@{{PROJECT_ID}}.iam.gserviceaccount.com